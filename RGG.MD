# Теория вероятностей в RGG или настоящий рандом

## Введение
Часто говорят, что в RGG рандом не настоящий, потому что стримерам часто выпадает одно и то же.
Используя теорию вероятностей, попробуем выяснить насколько такие совпадения вероятны и насколько случайный в RGG рандом .
## Немного теории
### Что такое вероятность?
Вероятность - это число от $0$ до $1$, которое показывает насколько событие вероятно. $0$ - событие невозможно, $1$ - событие обязательно произойдет.
Вероятность события можно посчитать по формуле:  
$$
p(a) = \frac{m}{n}
$$
где $m$ - число благоприятных исходов, $n$ - общее число исходов.

### Вероятность противоположных событий
Вероятность противоположного события равна $1$ минус вероятность самого события:  
$$
\bar p({a}) = 1 - p(a)
$$
Например, вероятность того что не выпадет крысубль равна:  
$$
\bar p_{\text{крысубль}} = p_{\text{не крысубль}} = 1-p_{\text{крысубль}} = 1 - \frac{1}{2} = \frac{1}{2}
$$

### Вероятность совместных событий
Вероятность совместных событий равна произведению вероятностей событий:  
$$
p(a \cap b) = p(a) \cdot p(b)
$$
Например, вероятность того что выпадет крысубль два раза подряд или выпадет два крысубля на двух монетках:  
$$
p_{\text{крысубль 2 раза}} = p_{\text{крысубль}} \cdot p_{\text{крысубль}} = \frac{1}{2} \cdot \frac{1}{2} = \frac{1}{4}
$$

### Сочетания
[Сочетания](https://ru.wikipedia.org/wiki/Сочетание) - это количество способов выбрать k элементов из n элементов для случая, когда порядок не важен.  
$$
{n \choose k} = \frac{n!}{k!(n-k)!}
$$
Например, количество способов выбрать $2$ участника из $17$ участников RGG Land:  
$$
{17 \choose 2} = \frac{17!}{2!(17-2)!} = \frac{17!}{2! \cdot 15!} = \frac{17 \cdot 16}{2} = 136
$$

### Парадокс дней рождений
[Парадокс дней рождения](https://ru.wikipedia.org/wiki/Парадокс_дней_рождения) похож на пробему восприятия рандома в RGG,
по этому сначала разберемся в нем.  
Его утверждение состоит в том, что в группе, состоящей из $23$ или более человек, вероятность совпадения дней рождения (число и месяц) хотя бы у двух людей превышает $50%$.
Такое утверждение может показаться неочевидным, так как вероятность совпадения дней рождения двух человек с любым днём в году
$ \frac {1}{365}=0{,}27\,\%$
умноженная на число человек в группе (23), даёт
$\frac {1}{365}\times 23=6{,}3\,\%$.  
Для того что бы на самом деле рассчитать вероятность того что хотя бы у двух человек совпадет день рождения,
нужно рассчитать вероятность того что у всех не совпадет день рождения и вычесть из $1$.
Возьмём наугад одного человека из группы и запомним его день рождения.
Затем возьмём наугад второго человека, при этом вероятность того, что у него день рождения не совпадёт с днем рождения
первого человека, равна:  
$$
1-{\frac {1}{365}}
$$
Затем возьмём третьего человека; при этом вероятность того, что его день рождения не совпадёт с днём рождения одного из первых двух, равна
$$
1-{\frac {2}{365}}
$$
Рассуждая по аналогии, мы дойдём до последнего человека, для которого вероятность несовпадения его дня рождения со всеми предыдущими будет равна
$$
1-{\frac {22}{365}}
$$
Таким образом, вероятность того, что у всех $23$ человек дни рождения не совпадут, равна:  
$$
\bar{p}(23) = 1 \cdot \left(1 - \frac{1}{365}\right) \cdot \left(1 - \frac{2}{365}\right) \cdot \ldots \cdot \left(1 - \frac{22}{365}\right)
=\frac{365 \cdot 364 \cdot 363 \cdot \ldots \cdot 343}{365^{23}}= \frac{365!}{365^{23} \cdot (365 - 23)!} \approx 49.27\%
$$
Тогда вероятность того, что хотя бы у двух человек из $23$ дни рождения совпадут, равна:  
$$
p(22) = 1 - \bar{p}(22) \approx 50.73\%
$$
А общая формула для вероятности совпадения дней рождения в группе из $n$ человек выглядит следующим образом:  
$$
p(n) = 1 - \bar{p}(n) = 1 - \frac{365!}{365^{n} \cdot (365 - n)!}
$$
В группе из $23$ человек вероятность совпадения дней рождения у двух человек такая высокая, 
потому что рассматривается вероятность совпадения дней рождения у любых двух человек в группе.
Эта вероятность определяется количеством пар людей, которые можно составить из $23$ человек.
Так как порядок людей в парах не имеет значения, общее число таких пар равно [числу сочетаний](https://ru.wikipedia.org/wiki/Сочетание) из 23 по 2, то есть:
$$
\frac{23 × 22}{2}=253
$$

Распространённое заблуждение состоит в том, что этот случай путают с другим случаем,
когда из группы выбирается один человек и оценивается вероятность того,
что день рождения каких-либо других членов группы совпадёт с днём рождения выбранного человека.
В последнем случае вероятность совпадения значительно ниже.

### Биноминальное распределение
[Биноминальное распределение](https://ru.wikipedia.org/wiki/Биномиальное_распределение) позволяет найти вероятность того,
что событие произойдёт ровно $k$ раз в $n$ независимых испытаниях с постоянной вероятностью  $p$ .
Формула биномиального распределения выглядит следующим образом:
$$
p(x = k) = \binom{n}{k} \cdot p^k \cdot (1 - p)^{n - k}
$$
- $p$ — вероятность того, что событие **произойдёт** в одном испытании.
- $1 - p$ — вероятность того, что событие **не произойдёт** в одном испытании.
- $n$ — общее количество испытаний.
- $k$ — количество успешных исходов, которое нас интересует.
Если вероятность выпадения крысубля при подбрасывании монеты равна  $p = \frac{1}{2}$ и мы подбрасываем монетку $10$ раз,
то вероятность того, что крысубль выпадет **ровно** $6$ раз:
$$
p(x = 6) = \binom{10}{6} \cdot (\frac{1}{2})^6 \cdot (1 - \frac{1}{2})^{10 - 6}= \frac{105}{512} \approx 20.5\%
$$
## Примеры из RGG
### Пример 1 - Игры
17 участников сезона RGG роллят игры из спецролла **Souls-like**, в котором 34 игры,
какая вероятность того что у двух участников выпадет одна и та же игра?
Какая вероятность того, что будет три и более пары участников играющих в одинаковые игры?

#### **1. Найдем вероятность того, что ни одной паре участников не выпадет одна и та же игра**
Вероятность можно найти таким же способом, как и в примере с днями рождения:
$$
p_{\text{все игры разные}} = 1 \cdot \left(1 - \frac{1}{34}\right) \cdot \left(1 - \frac{2}{34}\right) \cdot \ldots \cdot \left(1 - \frac{16}{34}\right)
=\frac{34 \cdot 33 \cdot 32 \cdot \ldots \cdot 18}{34^{17}}= \frac{34!}{34^{17} \cdot (34 - 17)!} \approx 0.77\%
$$

#### **2. Вероятность того, что хотя бы у двух участников выпадет одна и та же игра**
$$
p_{\text{игра совпала}} = 1 - p_{\text{все игры разные}} \approx 99.23\%
$$
Выходит, что если все участники роллят игры из небольшого спецролла, то почти обязательно у кого-то будут одинаковые игры.

#### **3. Найдем вероятность того, что ровно одной паре выпадет одинаковая игра**
Нужно найти вероятность того, что одной паре участников выпадет одна и та же игра, а остальные игры будут разными:
Сначала найдем количество возможных пар участников по формуле сочетаний:
$$
{17 \choose 2}= \frac{17!}{2!\cdot (17-2)!}= \frac{17!}{2!\cdot 15!} = \frac{17 \cdot 16}{2} = 136
$$
В качестве игр может быть любая из 36 игр, а количество способов выбрать одну игру из 36 равно 36.
Оставшиеся 15 участников должны выбрать разные игры, найдем количество способов выбрать 15 игр из 35 оставшихся,
порядок в данном случае будет важен, потому что, участники роллят игру последовательно:
$$
\frac{33!}{(33 - 15)!} = \frac{33!}{18!}
$$
Общее количество способов, как 17 участников могут получить себе игры из 34 игр - $34^{17}$.
Для того что бы найти вероятность того что ровно одной паре участников выпадет одна и та же игра, нужно умножить количество возможных пар на количество способов выбрать одну игру из 34 и количество способов выбрать 15 разных игр из 33 и поделить на общее количество способов выбрать 17 игр из 34:
$$
p_{\text{одна пара}} = \frac {34\cdot \frac{17\cdot16}{2} \cdot \frac{33!}{(33 - 15)!}}{34^{17}} \approx 5.78\%
$$
#### **3. Найдем вероятность того, что ровно двум парам выпадут одинаковые игры**
Нужно найти вероятность того, что двум парам участников выпадут одни и те же игры, а остальные игры будут разными.
Тут два варианта, либо две пары играют в одну и ту же игру, либо одна пара играет в одну игру, а другая пара в другую.
Сначала найдем количество возможных пар участников по формуле сочетаний. Сначала для первой пары:
$$
{17 \choose 2} = \frac{17 \cdot 16}{2} = 136
$$
Для второй пары:
$$
{15 \choose 2} = \frac{15 \cdot 14}{2} = 105
$$
Способов выбрать две игры для двух пар из 34 игр, тут порядок не важен при выборе двух игр, потому что мы учитываем только какие игры выбраны, а не в каком порядке
$$
{34 \choose 2} = \frac{34 \cdot 33}{2} = 561
$$
Оставшиеся 13 участников должны выбрать разные игры, найдем количество способов выбрать 13 игр из 35 оставшихся, порядок в данном случае порядок так же важен:
$$
\frac{33!}{(33 - 13)!} = \frac{33!}{20!}
$$
Для случая когда одна пара играет в одну игру:
$$
p_{\text{две игры}} = \frac {\frac{34 \cdot33}{2}\cdot\frac{17\cdot16}{2}\cdot\frac{15\cdot14}{2} \cdot \frac{32!}{(32 - 13)!}}{34^{17}} \approx 15.98\%
$$
Для случая когда две пары играют в одну игру:
$$
p_{\text{одна игра}} = \frac {34\cdot\frac{17\cdot16}{2}\cdot\frac{15\cdot14}{2} \cdot \frac{33!}{(33 - 13)!}}{34^{17}} \approx 1.60\%
$$
$$
p_{\text{две пары}} = p_{\text{две игры}} + p_{\text{одна игра}} \approx 17.58\%
$$
#### **4. Найдем вероятность того, что будет три и более пары участников играющих в одинаковые игры**
Для этого вычтем из вероятности того что будет хотя бы одна пара, вероятности того что будет ровно одна пара и вероятности того что будет ровно две пары:
$$
p_{\text{три и более пары}} = p_{\text{игра совпала}} - p_{\text{одна пара}} - p_{\text{две пары}} \approx 76.44\%
$$
#### Вывод
Для маленьких спецроллов на RGG, которые крутят все участники, вероятность того, что у двух участников выпадет одна и та же игра практически равна **100**%.
А три и более игры, в которые играют минимум по два участника, мы будем видеть приблизительно в **трех** случаях из **четырех**.
Примерно это мы и наблюдали на RGG Land Chix 2 для спецролла **Souls-like**.

### Пример 2 - Колеса
В колесе добра $1600$ пунктов, $16$ стримера крутят по $200$ колес, а один - $500$ _(Привет, Игорь!)_.
Какая вероятность того, что один пункт колеса выпадет $7$ и более участникам?
Какая вероятность, что $10$ и более пунктов колеса выпадут $7$ участникам и более?

#### **1. Найдем вероятность того, что конкретный пункт выпадет ровно 7 участниками**
Для этого используем биноминальное распределение:
$$
p(x = 7) = \binom{17}{7} \cdot (p_{200})^{6} \cdot (p_{500}) \cdot (1 - p_{200})^{17 - 7}
$$
Где:
  - $ p_{200} = \frac{200}{1600} = \frac{1}{8}$ — вероятность того, что конкретный пункт выпадет одному из 16 участников, крутящему $200$ колес.
  - $ p_{500} = \frac{500}{1600} = \frac{5}{16}$ — вероятность того, что конкретный пункт выпадет участнику, крутящему $500$ колес.

$$
p(x = 7) = \binom{17}{7} \cdot \left(\frac{1}{8}\right)^6 \cdot \frac{5}{16} \cdot \left(\frac{7}{8}\right)^{10} \approx 0.61\%
$$

#### **2. Найдем вероятность того, что конкретный пункт не выпадет ровно $7$ участникам**
$$
p(x \neq 7) = 1 - p(x = 7) = 1 - 0.0061 \approx 99.39\%
$$
#### **3. Найдем вероятность того, что ни один из 1600 пунктов не выпадет ровно $7$ участникам**
$$
p_\text{ни один}(x = 7) = p(x \neq 7)^{1600} =0.9939^{1600}\approx 0.0056\%
$$

#### **4. Найдем вероятность того, что хотя бы один пункт выпадет ровно $7$ участникам**
Противоположное событие:

$$
p_{\text{хотя бы один}}(x = 7) = 1 - p_\text{ни один}(x = 7) \approx 99.9944\%
$$

#### **5. Найдем вероятность того, что конкретный пункт выпадет $7$ раз или более**
Для этого нам нужно сложить вероятности того, что конкретный пункт выпадет ровно $7$ раз, ровно $8$,
ровно $9$ и так далее до $17$.  
$$
p(x \geq 7) = \sum_{k=7}^{17} \binom{17}{k} \cdot (p_{200})^{k-1} \cdot (p_{500}) \cdot (1 - p_{200})^{17 - k} \approx 0.74\%
$$

#### **6. Найдем вероятность того, вероятность того, что конкретный пункт не выпадет $7$ раз или более**  
$$
p(x < 7) = 1 - p(x \geq 7) = 1 - 0.0074 \approx 99.26\%
$$
Это означает, что хотя бы 1 пункт **неизбежно** выпадет хотя бы 7 участникам.
#### **7. Найдем вероятность того, что меньше $10$ пунктов выпадут $7$ раз или более**
Для этого просуммируем вероятности того, что ровно $0$ пунктов выпадут $7$ раз или более, ровно $1$, ровно $2$, ... и так до $9$.  
$$
p_{\text{меньше 10 таких пунктов}} = \sum_{k=0}^{9} \binom{1600}{k} \cdot (p(x \geq 7))^k \cdot (p(x < 7))^{1600 - k} \approx 26.11\%
$$

#### **8. Найдем вероятность того, что $10$ и более пунктов выпадут $7$ раз или больше**

$$
p_{\text{10 и более пунктов}} = 1 - p_{\text{меньше 10 таких пунктов}} = 1 - 0.2611 \approx 73.89\%
$$

#### **Вывод**
Если участники будут крутить примерно по $200$ колес добра, а один из участников значительно больше,
то вероятность того, что один пункт колеса выпадет хотя бы $7$ участникам близка к $100\%$. 
А в трех случаях из четырех таких пунктов будет $10$ и более.

## **Заключение**
Статистика [предыдущих](https://rgg.land/fall24/stats) [сезонов](https://rgg.land/stats) незначительно отличается от
приведенных теоретических расчетов. При схожих вводных получился схожий результат. Это показывает, что рандом в RGG настоящий (случайный) или близкий к нему и имеет хорошее распределение. 
Так же это можно проверить в предстоящем RGG, если предварительно подготовить случайно-перемешанные списки колес добра
для каждого участника отдельно и убедиться что это не повлияет на итоговую статистику колес в конце сезона,
и эта статистика не будет сильно отличаться от статистики предыдущих сезонов. 
